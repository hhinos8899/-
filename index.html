<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>私人百家乐AI预测系统</title>
    <style>
        body {
            background-color: #f0f0f0;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        .main-container {
            display: block;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        .grid-container {
            display: flex;
            flex-direction: row;
            gap: 5px;
            padding: 15px;
            background-color: #d9d9d9;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .column {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .cell {
            width: 50px;
            height: 50px;
            background-color: white;
            border: 1px solid #999;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            user-select: none;
        }
        .cell.B { color: red; }
        .cell.P { color: blue; }

        .main-result {
            font-size: 20px;
            font-weight: bold;
        }
        .prediction-text {
            font-size: 14px;   /* ✅ 只稍微放大，清晰但不突兀 */
            color: #f5222d;
            position: absolute;
            bottom: 2px;
            width: 100%;
            text-align: center;
            font-weight: bold;
        }
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            justify-content: center;
        }
        button {
            padding: 8px 15px;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
            border: none;
        }
        #btn-b { background-color: red; color: white; }
        #btn-p { background-color: blue; color: white; }
        #btn-clear, #btn-back { background-color: gray; color: white; }

        .counter {
            font-size: 18px;
            margin-top: 15px;
            text-align: center;
            font-weight: bold;
        }
    </style>
</head>
<body>
<div class="main-container">
    <h1 style="text-align:center;">私人百家乐AI预测系统</h1>

    <div class="grid-container"></div>

    <div class="counter">已输入：<span id="input-count">0</span> 局</div>

    <div class="button-group">
        <button id="btn-b">B（庄）</button>
        <button id="btn-p">P（闲）</button>
        <button id="btn-clear">清除</button>
        <button id="btn-back">退格</button>
    </div>
</div>

<script>
const MAX = 60;
const predictionRounds = [7,10,13,16,19,22,25,28,31,34,37,40,43,46,49,52,55,58];

let results = [];

const gridContainer = document.querySelector('.grid-container');

function initGrid(){
    gridContainer.innerHTML = '';
    for(let i=0;i<10;i++){
        const col = document.createElement('div');
        col.className = 'column';
        for(let j=0;j<6;j++){
            const idx = i*6+j;
            const cell = document.createElement('div');
            cell.className = 'cell';
            cell.dataset.index = idx;

            const main = document.createElement('div');
            main.className = 'main-result';

            const pred = document.createElement('div');
            pred.className = 'prediction-text';

            cell.appendChild(main);
            cell.appendChild(pred);
            col.appendChild(cell);
        }
        gridContainer.appendChild(col);
    }
}
initGrid();

function lastTwoBP(){
    const bp = results.filter(x=>x==='B'||x==='P');
    if(bp.length < 2) return null;
    return bp.slice(-2);
}

/* === 18 套规则（原样不动） === */
const RULES = [
 ({a,b})=>a==="P"&&b==="B"?"B":a==="P"&&b==="P"?"P":a==="B"&&b==="P"?"B":"P",
 ({a,b})=>a==="B"&&b==="B"?"B":a==="B"&&b==="P"?"P":a==="P"&&b==="P"?"B":"P",
 ({a,b})=>a==="P"&&b==="P"?"P":a==="P"&&b==="B"?"B":a==="B"&&b==="P"?"B":"P",
 ({a,b})=>a==="P"&&b==="B"?"B":a==="P"&&b==="P"?"P":a==="B"&&b==="P"?"B":"P",
 ({a,b})=>a==="B"&&b==="P"?"P":a==="B"&&b==="B"?"B":a==="P"&&b==="P"?"B":"P",
 ({a,b})=>a==="P"&&b==="P"?"P":a==="P"&&b==="B"?"B":a==="B"&&b==="P"?"B":"P",
 ({a,b})=>a==="P"&&b==="B"?"B":a==="P"&&b==="P"?"P":a==="B"&&b==="P"?"B":"P",
 ({a,b})=>a===b?"B":"P",
 ({a,b})=>a==="P"&&b==="B"?"B":a==="P"&&b==="P"?"P":a==="B"&&b==="P"?"B":"P",
 ({a,b})=>a==="B"&&b==="B"?"B":a==="B"&&b==="P"?"P":a==="P"&&b==="P"?"B":"P",
 ({a,b})=>a==="P"&&b==="P"?"P":a==="P"&&b==="B"?"B":a==="B"&&b==="P"?"B":"P",
 ({a,b})=>a==="P"&&b==="B"?"B":a==="P"&&b==="P"?"P":a==="B"&&b==="P"?"B":"P",
 ({a,b})=>a===b?"B":"P",
 ({a,b})=>a===b?"P":"B",
 ({a,b})=>a===b?"B":"P",
 ({a,b})=>a===b?"P":"B",
 ({a,b})=>a===b?"P":"B",
 ({a,b})=>a===b?"B":"P",
];

function render(){
    document.getElementById('input-count').textContent = results.length;
    document.querySelectorAll('.cell').forEach(c=>{
        c.className='cell';
        c.querySelector('.main-result').textContent='';
        c.querySelector('.prediction-text').textContent='';
    });

    results.forEach((v,i)=>{
        const cell=document.querySelector(`.cell[data-index="${i}"]`);
        cell.className='cell '+v;
        cell.querySelector('.main-result').textContent=v;
    });

    /* === ✅ 唯一改动点：只要 ≥6 把就允许预测 === */
    const next = results.length + 1;
    const ruleIndex = predictionRounds.indexOf(next);
    const last2 = lastTwoBP();

    if(ruleIndex>=0 && results.length>=6 && last2){
        const p = RULES[ruleIndex]({a:last2[0],b:last2[1]});
        const cell=document.querySelector(`.cell[data-index="${results.length}"]`);
        if(cell){
            cell.querySelector('.prediction-text').textContent = '预测:'+p;
        }
    }
}

document.getElementById('btn-b').onclick=()=>{ if(results.length<MAX){results.push('B');render();}};
document.getElementById('btn-p').onclick=()=>{ if(results.length<MAX){results.push('P');render();}};
document.getElementById('btn-back').onclick=()=>{ results.pop(); render(); };
document.getElementById('btn-clear').onclick=()=>{ results=[]; render(); };

render();
</script>
</body>
</html>
